#  Сетевой уровень: Резюме

<!-- 8.6.1 -->
##  Что я изучил в этом модуле?

**Характеристики сетевого уровня**

Сетевой уровень, или третий уровень модели OSI, предоставляет сервисы, позволяющие оконечным устройствам обмениваться данными по сети. IPv4 и IPv6 являются протоколами связи основного сетевого уровня. Сетевой уровень также включает протокол маршрутизации OSPF и протоколы обмена сообщениями, такие как ICMP. Протоколы сетевого уровня выполняют четыре основных операции: адресация конечных устройств, инкапсуляция, маршрутизация и деинкапсуляция. Функция протоколов сетевого уровня IPv4 и IPv6 определяет структуру и способ обработки пакетов, используемые для передачи данных с одного узла на другой. На сетевом уровне протокол IP инкапсулирует сегмент транспортного уровня, добавляя заголовок IP для доставки до хоста назначения. IP-заголовок проверяется устройствами уровня 3 (т.е. маршрутизаторами и коммутаторами уровня 3), когда он перемещается по сети к месту назначения. Характеристики IP: без установления соединения, негарантированная доставка и независимость от среды. IP является протоколом без установления соединения, а это означает, что перед отправкой данных выделенное сквозное соединение не устанавливается. Протокол IP не гарантирует получение всех доставляемых пакетов. Это определение ненадежной или негарантированной доставки. Протокол IP действует независимо от среды, которая служит для передачи данных на нижних уровнях стека протоколов.

**Пакет IPv4**

Заголовок пакета IPv4 состоит из нескольких полей, включающих  информацию о пакете. Эти поля содержат двоичные числа, которые анализируются процессом уровня 3. Двоичные значения каждого поля определяют различные параметры IP-пакета. Важные поля в заголовке IPv6 включают: версию, DS, контрольную сумму заголовка, TTL, протокол, а также адреса источника и назначения IPv4.

**Пакет IPv6**

IPv6 предназначен для преодоления ограничений IPv4, включая: истощение адресов IPv4, отсутствие сквозного подключения и повышенную сложность сети. IPv6 увеличивает доступное адресное пространство, улучшает обработку пакетов и устраняет необходимость в NAT. Заголовок IPv6 содержит следующие поля: версия, класс трафика, метка потока, длина полезной нагрузки, следующий заголовок, предел переходов, адрес источника и адрес назначения.

**Как хост маршрутизирует пакеты**

Хост может отправить пакет самому себе, другому локальному узлу и удаленному узлу. В IPv4 исходное устройство использует собственную маску подсети вместе с собственным адресом IPv4 и адресом назначения IPv4 для определения того, находится ли узел назначения в одной сети. В IPv6 локальный маршрутизатор объявляет адрес локальной сети (префикс) всем устройствам в сети. Шлюз по умолчанию — это сетевое устройство (т. е. маршрутизатор), которое направляет трафик в другие сети. В сети шлюзом по умолчанию обычно является маршрутизатор, который имеет локальный IP-адрес в том же диапазоне адресов, что и другие узлы в локальной сети, может принимать данные в локальную сеть и пересылать данные из локальной сети, а также направлять трафик в другие сети. Таблица маршрутизации узла, как правило, содержит шлюз по умолчанию. В IPv4, узел получает IPv4-адрес шлюза по умолчанию динамически от протокола динамической настройки узла (DHCP) или из вручную настроенных параметров. В IPv6 маршрутизатор объявляет адрес шлюза по умолчанию, или узел можно настроить вручную. На узле Windows команда **route print** или **netstat -r** можно использовать для отображения таблицы маршрутизации узла.

**Введение в маршрутизацию**

Когда узел отправляет пакет другому узлу, он использует свою таблицу маршрутизации, чтобы определить место отправки пакета. Если узел назначения находится в удаленной сети, пакет пересылается на шлюз по умолчанию, который обычно является локальным маршрутизатором. Что происходит, когда пакет поступает на интерфейс маршрутизатора? Маршрутизатор считывает IP-адрес назначения и просматривает свою таблицу маршрутизации, определяя, куда нужно переслать пакет. Таблица маршрутизации содержит список всех известных сетевых адресов (префиксов) и куда пересылать пакет. Эти записи известны как записи маршрута или маршруты. Маршрутизатор пересылает пакет, используя наилучшую соответствующую запись маршрута. В таблице маршрутизации маршрутизатора хранятся три типа записей маршрута: напрямую подключенные сети, удаленные сети и маршрут по умолчанию. Маршрутизаторы получают данные об удаленных сетях динамично, используя протоколы маршрутизации, или через настроенные оператором вручную статические маршруты. Статические маршруты - это записи маршрутов, которые настраиваются вручную. Статический маршрут включает в себя адрес удаленной сети и IP-адрес маршрутизатора следующего перехода. OSPF и EIGRP — это два протокола динамической маршрутизации. Команда **show ip route** привилегированного режима EXEC используется для просмотра таблицы маршрутизации IPv4 на маршрутизаторе Cisco IOS. В начале каждой записи таблицы маршрутизации находится код, который используется для идентификации типа маршрута или способа его изучения. Общие источники маршрутов (коды) включают:

**L** - IP-адрес локального интерфейса с прямым подключением

**C** - Присоединенная напрямую сеть

**S** - Статический маршрут был вручную настроен администратором

**O** - Open Shortest Path First (OSPF)

**D** - Enhanced Interior Gateway Routing Protocol (EIGRP)

<!-- 8.6.2 -->
<!-- quiz -->


<!-- verified: agorbachev 03.05.2022 -->

<!-- 10.3.1 -->
## Шлюз по умолчанию для хоста

Если в локальной сети только один маршрутизатор, он будет выполнять роль шлюза. Все узлы и коммутаторы в сети нужно настроить с учетом этой информации. Если в локальной сети несколько маршрутизаторов, необходимо выбрать один из них в качестве шлюза по умолчанию. В этом разделе объясняем, как настроить шлюз по умолчанию на узлах и коммутаторах.

Чтобы оконечное устройство могло обмениваться данными по сети, ему необходимо присвоить правильный IP-адрес, включая адрес шлюза по умолчанию. Шлюз по умолчанию используется, когда узлу необходимо отправить пакет устройству в другой сети. Как правило, его адрес совпадает с адресом интерфейса маршрутизатора, связанным с локальной сетью, в которой находится узел. Адреса узлового устройства и интерфейса маршрутизатора должны находиться в одной сети.

Предположим, топология сети IPv4 состоит из маршрутизатора, соединяющего две отдельные локальные сети. G0/0 подключен к сети 192.168.10.0, а G0/0.1 — к сети 192.168.11.0. Для каждого главного устройства указан соответствующий адрес шлюза по умолчанию.

В этом примере, если PC1 отправляет пакет PC2, шлюз по умолчанию не используется. Вместо этого компьютер PC1 отправляет пакет с IPv4-адресом PC2 и пересылает этот пакет непосредственно к PC2 через коммутатор.

![](./assets/10.3.1-1.svg)


Что если PC1 отправил пакет на PC3? PC1 обратится к пакету с адресом IPv4 PC3, но перенаправит пакет на шлюз по умолчанию, то есть на интерфейс G0/0/0 R1. Маршрутизатор примет пакет, проверит таблицу маршрутизации и на основании адреса назначения определит подходящий выходной интерфейс. Затем R1 отправит пакет из соответствующего интерфейса на PC3.

![](./assets/10.3.1-2.svg)


Такой же процесс будет происходить в сети IPv6, хотя это не отображается в топологии. Устройства будут использовать IPv6 адрес локального маршрутизатора в качестве шлюза по умолчанию.

<!-- 10.3.2 -->
## Шлюз по умолчанию для коммутатора

Коммутатор, который соединяет клиентские компьютеры, обычно является устройством уровня 2. Для нормального функционирования ему не требуется IP-адрес. Однако, на коммутаторе можно настроить конфигурацию IP, чтобы предоставить администратору удаленный доступ.

Чтобы подключить коммутатор и управлять им через локальную IP-сеть, необходимо настроить виртуальный интерфейс коммутатора (SVI) с IPv4-адресом и маской подсети в локальной сети. Коммутатор также должен иметь адрес шлюза по умолчанию, настроенный для удаленного управления из другой сети.

Адрес основного шлюза, как правило, настроен на всех устройствах, которым необходим обмен данными за пределами своей локальной сети.

Чтобы настроить шлюз IPv4 по умолчанию на коммутаторе, используйте команду глобальной конфигурации **ip default-gateway** _ip-address_. Значение _ip-address_ является IPv4-адресом локального интерфейса маршрутизатора, подключенного к коммутатору.

На рисунке показан администратор, настраивающий удаленное подключение к коммутатору S1 другой сети.

![](./assets/10.3.2.svg)


В этом примере узел администратора использует шлюз по умолчанию для отправки пакета на интерфейс G0/0/1 R1. R1 переслал пакет S1 с интерфейса G0/0/0. Поскольку адрес источника пакета IPv4 поступает из другой сети, S1 потребуется шлюз по умолчанию для пересылки пакета на интерфейс G0/0/0 R1. Таким образом, для S1 необходимо настроить шлюз по умолчанию, чтобы он мог устанавливать SSH-соединение с компьютером администратора.

**Примечание:** Пакеты, которые создают узлы, подключенные к коммутатору, уже должны содержать информацию о шлюзе по умолчанию, настроенном для обмена данными в удаленных сетях.

Коммутатор рабочей группы также может быть настроен с IPv6-адресом на SVI. Однако на коммутаторе не нужно вручную настраивать IPv6-адреса шлюза по умолчанию. Он автоматически получит шлюз по умолчанию из сообщения ICMPv6 Router Advertisement от маршрутизатора.

<!-- 10.3.3 -->
<!-- syntax -->




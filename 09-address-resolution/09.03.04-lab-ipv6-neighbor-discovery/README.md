## Топология

![](./assets/topology.png)

## Таблица адресации

| Устройство | Интерфейс | IPv6-адрес/префикс    | Шлюз по умолчанию |
|------------|-----------|-----------------------|-------------------|
| RTA        | G0/0/0    | 2001:db8:acad:1።1/64  | Нет               |
| RTA        | G0/0/1    | 2001:db8:acad:1።1/64  | Нет               |
| PCA1       | NIC       | 2001:db8:acad:1። A/64 | fe80::1           |
| PCA2       | NIC       | 2001:db8:acad:1::B/64 | fe80::1           |
| PCB1       | NIC       | 2001:db8:acad:2። A/64 | fe80::1           |

## Цели

Часть 1. Локальная сеть обнаружения соседей IPv6

Часть 2: Удаленная сеть обнаружения соседей IPv6

## Общие сведения

Чтобы устройство могло взаимодействовать с другим устройством, должен быть известен MAC-адрес устройства назначения. В IPv6 процесс, называемый Обнаружение соседей с использованием протокола NDP или ND, отвечает за определение MAC-адреса назначения. Вы будете собирать информацию PDU в режиме моделирования, чтобы лучше понять процесс. Ддя этого задания Packet Tracer нет оценки.

## Инструкции

### Часть 1. Обнаружение соседних IPv6 устройств в локальной сети

В части 1 этого задания вы получите MAC-адрес устройства назначения в той же сети.

**Шаг 1. Проверьте маршрутизатор на наличие обнаруженных соседей.**

1.  Нажмите маршрутизатор RTA. Выберите вкладку CLI и выполните команду **show ipv6 neighbors** из привилегированного режима exec. Если отображаются какие-либо записи, удалите их с помощью команды **clear ipv6 neighbors**.

2.  Нажмите на **PCA1**, выберите вкладку Desktop и нажмите на значок **Command Prompt** (командной строки).

**Шаг 2. Переключитесь в режим моделирования для захвата событий.**

1.  Нажмите кнопку **Моделирование** в правом нижнем углу окна Топология в Packet Tracer.

2.  Нажмите кнопку « **Show All/None** » в левой нижней части панели моделирования. Убедитесь, что **Event List Filters – Visible Events** показывает **None**.

3.  В командной строке на **PCA1**выполните команду **ping —n 1 2001:db8:acad:1::b**. Это приведет к запуску процесса pinging **PCA2**.

4.  Нажмите кнопку **Play Capture Forward** , которая отображается в виде стрелки, указывающей вправо с вертикальной полоской в окне «Управление воспроизведением». В строке состояния над элементами управления воспроизведением должно быть указано «Captured» до 150. (Точное число может отличаться.)

5.  Нажмите кнопку **Edit** (Редактировать). Выберите вкладку IPv6 вверху и установите флажки для **ICMPv6** и **NDP** . Нажмите красный значок X в правом верхнем углу окна Редактировать фильтры ACL. Теперь необходимо перечислить захваченные события. В окне должно быть около 12 записей.

    - ответьте на вопрос №1

6.  Нажмите квадрат в столбце Тип для первого события, которое должно быть **ICMPv6**.

    - ответьте на вопрос №2

    Обратите внимание, что нет адресации уровня 2. Нажмите кнопку **Next Layer \>\>**, чтобы получить объяснение процесса ND (Neighbor Discovery).

7.  Нажмите квадрат рядом со следующим событием на панели моделирования. Он должен быть на устройстве PCA1 и тип должен быть NDP.

    Вопросы:

    - ответьте на вопрос №3

    - ответьте на вопрос №4

    Если узел не знает MAC-адрес назначения, специальный MAC-адрес многоадресной рассылки используется IPv6 Neighbor Discovery в качестве адреса назначения уровня 2.

8.  Выберите первое событие **NDP** в SwitchA.

    - ответьте на вопрос №5

9.  Выберите первое событие **NDP** на **PCA2** . Нажмите вкладку Outbound PDU Details (Сведения об исходящей PDU).

    Вопрос: Какие адреса отображаются для следующих?

    Примечание. Адреса в полях могут быть обернуты, отрегулировать размер окна PDU, чтобы сделать адресную информацию проще для чтения.

    Ethernet II DEST ADDR:

    Ethernet II SRC ADDR:

    IPv6 SRC IP:

    IPv6 DST IP:

10. Вопрос: Выберите первое событие **NDP** в **RTA** . 
    
    - ответьте на вопрос №6

11. Нажмите кнопку **Next Layer \>\>** до конца и прочитайте шаги с 4 по 7 для получения дальнейших разъяснений.

12. Нажмите следующее событие **ICMPv6** на **PCA1** .

    - ответьте на вопрос №7

13. Нажмите последнее событие **ICMPv6** на **PCA1** . Обратите внимание, что это последнее сообщение в списке.

    - ответьте на вопрос №8

14. Нажмите **Reset Simulation** на панели «Simulation». Из командной строки PCA1 повторите **ping** на PCA2. (Подсказка: вы должны иметь возможность нажать стрелку вверх, чтобы вернуть предыдущую команду.)

15. Нажмите кнопку **Capture Forward** 5 раз, чтобы завершить процесс ping.

    - ответьте на вопрос №9

### Часть 2. Обнаружение соседних IPv6 устройств в удаленной сети

В части 2 этого задания будут выполняться действия, аналогичные тем, которые приведены в части 1, за исключением того, что узел назначения находится в другой локальной сети. Обратите внимание, как процесс обнаружения соседей отличается от процесса, наблюдаемого в части 1. Обратите внимание на некоторые дополнительные шаги адресации, которые происходят, когда устройство взаимодействует с устройством, которое находится в другой сети.

Обязательно нажмите кнопку « **Reset Simulation** », чтобы очистить предыдущие события.

**Шаг 1. Захват событий для удаленной связи.**

1.  Отображение и очистите все записи в таблице соседних устройств IPv6, как это было сделано в части I.

2.  Перейдите в режим Simulation (Моделирование). Нажмите кнопку « **Show All/None** » в левой нижней части панели моделирования. Убедитесь, что **Event List Filters – Visible Events** показывает **None**.

3.  Из командной строки на PCA1 выполните команду **ping —n 1 2001:db8:acad:2::a** на хост PCB1.

4.  Нажмите кнопку **Play Capture Forward** , которая отображается в виде стрелки, указывающей вправо с вертикальной полоской в окне «Управление воспроизведением». В строке состояния над элементами управления воспроизведением должно быть указано «Captured» до 150. (Точное число может отличаться.)

5.  Нажмите кнопку **Edit** (Изменить). Выберите вкладку IPv6 вверху и установите флажки для **ICMPv6** и **NDP** . Щелкните красный значок X в правом верхнем углу окна Редактировать фильтры ACL. Теперь должны быть перечислены все предыдущие события. Вы должны заметить, что на этот раз значительно больше записей.

6.  Нажмите квадрат в столбце типа для первого события, которое должно быть **ICMPv6**. Поскольку сообщение начинается с этого события, существует только исходящий PDU. Обратите внимание, что в нем отсутствует информация о слое 2, как это было в предыдущем сценарии.

7.  Нажмите первое событие **NDP** на устройстве **PCA1** .

    - ответьте на вопрос №10

    Обнаружение соседей IPv6 определяет следующий пункт назначения для пересылки сообщения ICMPv6.

8.  Нажмите второе событие ICMPv6 для **PCA1**. PCA1 теперь имеет достаточно информации для создания эхо-запроса ICMPv6.

    - ответьте на вопрос №11

9.  Нажмите следующее событие ICMPv6 на устройстве **RTA**. Обратите внимание, что исходящий PDU от RTA не имеет адреса уровня назначения 2. Это означает, что RTA снова должен выполнить обнаружение соседей для интерфейса, который имеет сеть 2001:db8:acad:2::: потому что он не знает MAC-адреса устройств в локальной сети G0/0/1.

10. Перейдите к первому событию ICMPv6 для устройства **PCB1**.

    - ответьте на вопрос №12

11. Следующие несколько событий **NDP** связывают оставшиеся адреса IPv6 с MAC-адресами. Предыдущие события NDP связывали MAC-адреса с локальными адресами связи.

12. Перейдите к последнему набору событий ICMPv6 и обратите внимание, что все адреса были изучены. Необходимая информация теперь известна, поэтому PCB1 может отправлять эхо-ответные сообщения на PCA1.

13. Щелкните Reset Simulation на панели «Simulation». Из командной строки PCA1 повторите команду ping PCB1.

14. Нажмите кнопку Capture Forward девять раз, чтобы завершить процесс ping.

    - ответьте на вопрос №13

15. Нажмите единственное событие **PCB1** в новом списке.

    Вопросы:

    - ответьте на вопрос №14

    - ответьте на вопрос №15

**Шаг 2. Проверьте выходы маршрутизатора.**

1.  Вернитесь в режим реального времени (**Realtime**).

2.  Нажмите кнопку **RTA** и выберите вкладку CLI. В командной строке маршрутизатора введите команду **show ipv6 neighbors**.

    Вопросы:

    - ответьте на вопрос №16

    - ответьте на вопрос №17

    - ответьте на вопрос №18

3.  Запустите эхо-запрос до **PCA2** с маршрутизатора.

4.  Выполните команду **show lldp neighbors**.

    - ответьте на вопрос №19

## Вопросы для повторения

- ответьте на вопрос №20

- ответьте на вопрос №21

- ответьте на вопрос №22

- ответьте на вопрос №23

[Скачать файл Packet Tracer для локального запуска](./assets/9.3.4-lab.pka)
